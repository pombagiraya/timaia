<div class="container">
  <div class="row justify-content-center">
    <col-6 class="col-md-8">
      <h1><%= @apartment.building.building_name %></h1>
      <h3>Apto <%= @apartment.apt_number %></h3>
      <button type="button" class="btn btn-light"><%= link_to "Edit", edit_apartment_path(@apartment) %></button>
      <button type="button" class="btn btn-light"><%= link_to "Delete", apartment_path(@apartment), method: :delete, data: {confirm: "Are you sure?"} %></button>
      <p>Owner: <%= @apartment.user.name %></p>
      <p>Bill: <%= @apartment.bill %></p>
      <p>Total Unpaid: <%= @unpaid %></p>
      <p>Total Unpaid and Overdue: <%= @unpaid_delay %></p>

  <h3>Payments</h3>
  <button type="button" class="btn btn-light">
    <%= link_to 'New Payment', new_apartment_payment_path(@apartment) %>
  </button>
  <table class="table">
    <thead>
    <tr>
      <th scope="col">Date</th>
      <th scope="col">Status</th>
      <th scope="col">Payment</th>
      <th scope="col">Actions</th>
    </tr>
  </thead>
  <tbody>
    <% @apartment.payments.order(payment_date: :desc).each do |payment| %>
      <tr>
        <td><%= payment.payment_date %></td>
        <td><%=
          if payment.payment_date > Date.today
            'On time'
          else
            'Overdue'
          end
          %></td>
        <td><%=
          case payment.status
            when 0 then 'Unpaid'
            when 1 then 'Paid'
          end
          %></td>
        <td>
          <button type="button" class="btn btn-light"><%= link_to "Edit", edit_payment_path(payment) %></button>
          <button type="button" class="btn btn-light"><%= link_to "Delete", payment_path(payment), method: :delete, data: {confirm: "Are you sure?"} %></button>
        </th>
      </td>
    <% end %>
    </table>
    <button type="button" class="btn btn-light"><%= link_to 'Back', building_path(@apartment.building_id) %></button>
  </col-6>
  </div>
</div>
